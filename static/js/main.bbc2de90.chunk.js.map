{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["provider","signer","contract","accounts","connectedNetwork","rarityAddress","App","useState","msg","setMsg","walletStatus","setWalletStatus","reward","setReward","sp","Array","fill","squarePattern","setSquarePattern","s","patternLimit","setPatternLimit","address","setAddress","submissionFee","setFee","a","walletConnected","window","ethereum","request","method","initialize","ethers","providers","Web3Provider","getNetwork","getSigner","getAddress","Contract","Rarity","abi","pL","toString","utils","fee","sFee","formatEther","fFee","toFixed","eventFilter","filters","newPattern","on","metadata","event","console","log","refreshAccount","message","fetchPatterns","checkReward","length","chainId","name","overrides","value","parseEther","submitPattern","claimReward","claim","wait","receipt","_reward","status","parseInt","res","useEffect","patternGrid","setPatternGrid","newGrid","fetchPatternIDs","data","i","fetchPattern","pattern","patternIsActive","grid","selected","squareClicked","newStyle","background","className","style","onClick","slice","gridArray","grids","push","multiGrid","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.bbc2de90.chunk.js","sourcesContent":["import './App.css';\nimport { useEffect, useState } from 'react';\nimport { ethers } from 'ethers' \nimport Rarity from './artifacts/contracts/Rarity.sol/Rarity.json'\n\n// Update with the contract address logged out to the CLI when it was deployed \nconst rarityAddress = \"0x8E64fa6455D8A30548Ff1313D03b69B2EB4A7650\"\nlet provider \nlet signer\nlet contract \nlet accounts\nconst  numSquares = 9\nconst networkID = 3 //ropsten\n//const networkID = 1337 //localhost\nlet  connectedNetwork  \n\nfunction App() {\n\n  const [msg, setMsg] = useState()\n  const [walletStatus, setWalletStatus] = useState(\"Connect Wallet\")\n  const [reward, setReward] = useState(\"0.0\")\n  const sp = new Array(numSquares).fill(0)\n  const [squarePattern, setSquarePattern] = useState(sp)\n  const s = new Array(numSquares)\n  const [patternLimit, setPatternLimit] = useState(\"?\")\n  const [address, setAddress] = useState()\n  const [submissionFee, setFee] = useState(\"?\")\n\n  useEffect(() => {\n    initialize()\n  },[])\n  \n  async function connectWallet() {\n    if(walletConnected())return\n      accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });\n      initialize()\n  }\n  \n  async function initialize() {\n    if (window.ethereum) {\n      try {\n        //console.log(\"initializing\")\n        accounts = await window.ethereum.request({ method: 'eth_accounts' });\n        provider = new ethers.providers.Web3Provider(window.ethereum)\n        connectedNetwork  = await provider.getNetwork()\n        signer = provider.getSigner()\n        setAddress( await signer.getAddress())\n        contract = new ethers.Contract(rarityAddress, Rarity.abi, signer)\n        const pL = await contract.patternLimit()\n        setPatternLimit(pL.toString())\n        const sFee = ethers.utils.formatEther(await contract.fee())\n        const fFee = (+sFee).toFixed(2)\n        setFee(fFee)\n\n        const eventFilter = contract.filters.newPattern(address, null)\n        \n        //set event listener\n        contract.on(eventFilter, (  metadata, event) => {\n          console.log('Address  :', metadata);\n          console.log('Pattern Id : ', event.toString());  //Event object\n          setMsg(`Pattern ID No. ${event.toString()} has been submitted!`)\n          refreshAccount()\n        });\n        \n      } catch (err) {\n        console.log(\"Error connecting Wallet: \"+ err.message)\n        walletConnected()\n        return false\n      }\n      setMsg(\"\")\n      refreshAccount()\n    } else {\n      setMsg(\"Please install Metamask\")\n      return false\n    }\n  }\n\n  function refreshAccount() { \n      fetchPatterns()\n      checkReward()\n  }\n\n  function walletConnected() {\n    if (window.ethereum && accounts && accounts.length > 0) {\n      setWalletStatus(\"Wallet Connected\")\n      if (connectedNetwork.chainId !== networkID && ethers.providers){ \n        setMsg(\"Please connect to the \" + ethers.providers.getNetwork(networkID).name + \" Network\")\n        return false\n      }\n      return true\n    } else {\n      setWalletStatus(\"Connect Wallet\")\n      setAddress(\"\")\n      setMsg(\"Please Connect Wallet\")\n      return false\n    }\n  }\n\n  async function submitPattern() {\n    if (!walletConnected()) return\n    let overrides = {\n      value: ethers.utils.parseEther(\"0.1\")     // ether in this case MUST be a string\n    }; \n    console.log(\"send tx: \", squarePattern);\n    let transaction;\n    try {\n      transaction = await contract.submitPattern(squarePattern, overrides)\n    } catch (err) {\n      setMsg(err.message)\n      return false\n    }\n    setMsg(\"Tx Pending\")\n    /* Instead of using a receipt we are listening for the event now\n    const receipt = await transaction.wait()\n    if(receipt.status === 1) {\n      setMsg(\"Pattern submission sucessful!\")\n    } else {\n      setMsg(\"There was an error submitting your pattern, please try again\")\n      return false;\n    }\n    */\n  }\n  \n\n  async function claimReward() {\n    if (!walletConnected()) return\n    if (reward === 0) {\n      setMsg(\"No Reward to Claim\")\n      return\n    }\n    let claim\n    try {\n    claim = await contract.claimReward();\n    } catch (err) {\n      setMsg(err.message)\n      return false\n    }\n    setMsg(\"Tx Pending\")\n    const receipt = await claim.wait()\n    //wait for transaction to finish\n    //check the reward amount, update msg, check that reward is zeroed out\n    const _reward = await checkReward() \n    console.log(_reward)\n    if(receipt.status === 1 && parseInt(_reward) === 0) {\n      setMsg(reward + \" Eth Reward Claimed Sucessfully\")\n    } else {\n      setMsg(\"There was an error, please try again\")\n      return false;\n    }\n  }\n\n  async function checkReward() {\n    if (!walletConnected()) return\n    try {\n      const _reward = ethers.utils.formatEther(await contract.checkReward())\n      const res = (+_reward).toFixed(2);\n      setReward(res)\n      return _reward\n    } catch (err) {\n      setMsg(err)\n    }\n  }\n\n  const [patternGrid, setPatternGrid]  = useState(s)\n\n  async function fetchPatterns() {\n    if (!walletConnected()) return\n\n      try {\n        const newGrid = new Array() \n        const data = await contract.fetchPatternIDs()\n        if(data.length > 0){\n          for (let i = 0; i < data.length; i++) {\n            const pattern = await contract.fetchPattern(data[i])\n            const active = await contract.patternIsActive(data[i])\n            if(active){\n              newGrid[i] = new Array()\n              console.log(pattern)\n              newGrid[i] = pattern// = pattern.map(x => x.toNumber())\n            }\n          }\n          setPatternGrid(newGrid)\n        } else {\n          //setSavedPatterns(\"No Patterns Found\")\n        }\n\n      } catch (err) {\n        setMsg(err)\n      }\n  }\n\n  function changeStyle(i){\n    const newPattern = squarePattern.slice()\n    if(!newPattern[i]) {\n      newPattern[i] = 1\n    }else {\n      newPattern[i] = 0\n    }\n    setSquarePattern(newPattern)\n  }\n  \n  function multiGrid(gridArray){\n    if(gridArray && gridArray.length){\n      const grids = new Array()\n      for (let i = 0; i < gridArray.length; i++) {\n        if(gridArray[i]){\n          //console.log(i)\n          grids.push(\n          <div className = \"activePatterns\">\n            <span className = \"id\" >ID: {i}</span>\n            {grid(gridArray[i])}\n          </div>\n          )\n        }\n      }\n      return grids\n    }\n  }\n\n  function grid(selected, squareClicked = () => {}){\n    let newStyle = new Array(numSquares)\n    //use the array to set square style\n    if(!selected) return \n    for (let i = 0; i < selected.length; i++) {\n\n    if(selected[i]) {\n      newStyle[i] = { background : 'grey'}\n    }else {\n      newStyle[i] = {background : 'white'}\n    }\n  }\n\n    return(\n      <div className=\"game\">\n        <div className=\"game-board\">\n          <div className=\"board-row\">\n            <button className=\"square\" style={newStyle[0]} onClick={() =>squareClicked(0)}></button>\n            <button className=\"square\" style={newStyle[1]} onClick={() =>squareClicked(1)}></button>\n            <button className=\"square\" style={newStyle[2]} onClick={() =>squareClicked(2)}></button>\n          </div>\n          <div className=\"board-row\">\n            <button className=\"square\" style={newStyle[3]} onClick={() =>squareClicked(3)}></button>\n            <button className=\"square\" style={newStyle[4]} onClick={() =>squareClicked(4)}></button>\n            <button className=\"square\" style={newStyle[5]} onClick={() =>squareClicked(5)}></button>\n          </div>\n          <div className=\"board-row\">\n            <button className=\"square\" style={newStyle[6]} onClick={() =>squareClicked(6)}></button>\n            <button className=\"square\" style={newStyle[7]} onClick={() =>squareClicked(7)}></button>\n            <button className=\"square\" style={newStyle[8]} onClick={() =>squareClicked(8)}></button>\n          </div>\n        </div>\n      </div>\n      //<input onChange={e => setPatternValue(e.target.value)} placeholder=\"Submit Pattern\" />\n    )\n  }\n\n  return (\n    <div className=\"App\">\n      <div className=\"topBar\">\n        <div className=\"claim\">\n          <button onClick={claimReward}>Claim Reward</button>\n          <span className=\"reward\">Reward: {reward} Eth</span>\n        </div>\n\n        <div className=\"wallet\">\n          <button onClick={connectWallet}>{walletStatus}</button>\n          <div className=\"address\">{address && address.slice(0,5) + \"...\" + address.slice(-4)}</div>\n        </div>\n      </div>\n      <div className=\"msg\">{msg}</div>\n      <h1 className=\"Title\">The Rarity Game</h1>\n      <div className=\"gameContainer\">\n        <div className=\"gameAndButton\">\n          {grid(squarePattern, changeStyle)}\n          <button onClick={submitPattern}>Save Pattern</button>\n        </div>\n        <div className=\"instructions\">\n          <ul>\n            <b>Rules:</b>\n            <li>Create and submit a unique pattern by selecing boxes.</li>\n            <li>After the pattern limit of {patternLimit} patterns is reached, \n            each new pattern submission will trigger a burn of the most common pattern submission</li>\n            <li>A pattern submissionn fee of {submissionFee} Eth is collected and evenly divided up amongst current patterns</li>\n            <li>If a pattern is elimainated, the rewards it has earned remain available, but the pattern will earn no additional rewards</li> \n            <li>Pattern owners can withdraw rewards earned by their patterns at anytime</li> \n            <li>The longer your pattern stays active, the more rewards you earn!</li> \n          </ul>\n        </div>\n\n      </div>\n      <div>\n        <h2 className=\"app-pattern-title\">Your Active Patterns</h2>\n        <div className=\"app-pattern\">{multiGrid(patternGrid)}</div>\n      </div>\n    </div>\n  );\n}\n\n  \nexport default App\n//","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}